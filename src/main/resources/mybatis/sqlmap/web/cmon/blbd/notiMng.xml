<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cmon.blbd.notiMng">
	
	<select id="searchTcUserBase" parameterType="java.util.Map" resultType="MybatisMap">
	    select blbd_no
	    	  ,blbd_strt_dt
	    	  ,blbd_expr_dt
	    	  ,blbd_type_cd
		      ,blbd_titl
			  ,blbd_cntn
			  ,srch_cnt
			  ,alam_yn
			  ,reg_dt
			  ,reg_tm
			  ,reg_user_id
			  ,upt_dt
			  ,upt_tm
			  ,upt_user_id
		from   TS_BLBD_BASE
		where  1=1
		<if test=" userId != null and userId != '' ">
		and    blbd_no = #{blbdNo}		        </if>
		order  by blbd_no
	<if test=' paging == "Y" '>
    LIMIT ${rowCount} OFFSET ${currentIndex} </if>
	</select>

	<select id="searchNotiList" parameterType="java.util.Map" resultType="MybatisMap">
		select blbd_no
		,blbd_strt_dt
		,blbd_expr_dt
		,blbd_type_cd
		,blbd_titl
		,blbd_cntn
		,srch_cnt
		,alam_yn
		,reg_dt
		,reg_tm
		,reg_user_id
		,upt_dt
		,upt_tm
		,upt_user_id
		from   TS_BLBD_BASE
		where  1=1
		and    blbd_no = #{blbdNo}
	</select>
	
	<insert id="insertTcUserBase" parameterType="java.util.Map">
	insert into tc_api_stnd
	(
		 svr_id
		,svr_nm
		,api_url
		,gps_base_cycl
		,gps_next_cycl
		,rdet_next_cycl
		,rdet_base_cycl
		,led_slep_tcnt
		,msor_ssng_levl
		,hsor_isng_cycl
		,tsor_isng_cycl
		,tsor_evnt_minval
		,tsor_evnt_maxval
		,hbitcnt_mdan_minval
		,hbitcnt_mdan_maxval
		,msor_evnt_minval
		,msor_evnt_maxval
		,reg_dt
		,reg_tm
		,reg_user_id
		,upt_dt
		,upt_tm
		,upt_user_id
	)
	values
	(
		 #{svrId}
		,#{svrNm}
		,#{apiUrl}
		,#{gpsBaseCycl}::NUMERIC
		,#{gpsNextCycl}::NUMERIC
		,#{rdetNextCycl}::NUMERIC
		,#{rdetBaseCycl}::NUMERIC
		,#{ledSlepTcnt}::NUMERIC
		,#{msorSsngLevl}::NUMERIC
		,#{hsorIsngCycl}::NUMERIC
		,#{tsorIsngCycl}::NUMERIC
		,#{tsorEvntMinval}::NUMERIC
		,#{tsorEvntMaxval}::NUMERIC
		,#{hbitcntMdanMinval}::NUMERIC
		,#{hbitcntMdanMaxval}::NUMERIC
		,#{msorEvntMinval}::NUMERIC
		,#{msorEvntMaxval}::NUMERIC
		,TO_CHAR(NOW(), 'YYYYMMDD')
		,TO_CHAR(NOW(), 'HH24MISS')
		,#{regUserId}
		,TO_CHAR(NOW(), 'YYYYMMDD')
		,TO_CHAR(NOW(), 'HH24MISS')
		,#{uptUserId}
	)
	</insert>
	
	<update id="updateTcUserBase" parameterType="java.util.Map">
	UPDATE TC_API_STND
	SET    UPT_DT      = TO_CHAR(NOW(), 'YYYYMMDD')
	      ,UPT_TM      = TO_CHAR(NOW(), 'HH24MMIS')
	      ,UPT_USER_ID = #{uptUserId}
	      ,SVR_ID = #{svrId}
    	<if test="svrNm             != null and svrNm             != ''">,svr_nm              = #{svrNm}</if>
    	<if test="apiUrl            != null and apiUrl            != ''">,api_url             = #{apiUrl}</if>
    	<if test="gpsBaseCycl       != null and gpsBaseCycl       != ''">,gps_base_cycl       = #{gpsBaseCycl}::NUMERIC</if>
    	<if test="gpsNextCycl       != null and gpsNextCycl       != ''">,gps_next_cycl       = #{gpsNextCycl}::NUMERIC</if>
    	<if test="rdetNextCycl      != null and rdetNextCycl      != ''">,rdet_next_cycl      = #{rdetNextCycl}::NUMERIC</if>
    	<if test="rdetBaseCycl      != null and rdetBaseCycl      != ''">,rdet_base_cycl      = #{rdetBaseCycl}::NUMERIC</if>
    	<if test="ledSlepTcnt       != null and ledSlepTcnt       != ''">,led_slep_tcnt       = #{ledSlepTcnt}::NUMERIC</if>
    	<if test="msorSsngLevl      != null and msorSsngLevl      != ''">,msor_ssng_levl      = #{msorSsngLevl}::NUMERIC</if>
		<if test="hsorIsngCycl      != null and hsorIsngCycl      != ''">,hsor_isng_cycl      = #{hsorIsngCycl}::NUMERIC</if>
		<if test="tsorIsngCycl      != null and tsorIsngCycl      != ''">,tsor_isng_cycl      = #{tsorIsngCycl}::NUMERIC</if>
		<if test="tsorEvntMinval    != null and tsorEvntMinval    != ''">,tsor_evnt_minval    = #{tsorEvntMinval}::NUMERIC</if>
		<if test="tsorEvntMaxval    != null and tsorEvntMaxval    != ''">,tsor_evnt_maxval    = #{tsorEvntMaxval}::NUMERIC</if>
		<if test="hbitcntMdanMinval != null and hbitcntMdanMinval != ''">,hbitcnt_mdan_minval = #{hbitcntMdanMinval}::NUMERIC</if>
		<if test="hbitcntMdanMaxval != null and hbitcntMdanMaxval != ''">,hbitcnt_mdan_maxval = #{hbitcntMdanMaxval}::NUMERIC</if>
		<if test="msorEvntMinval    != null and msorEvntMinval    != ''">,msor_evnt_minval    = #{msorEvntMinval}::NUMERIC</if>
		<if test="msorEvntMaxval    != null and msorEvntMaxval    != ''">,msor_evnt_maxval    = #{msorEvntMaxval}::NUMERIC</if>
	     WHERE  1 = 1
	     AND    SVR_ID  = #{svrId}
	</update>
	
	<delete id="deleteTcUserBase" parameterType="java.util.Map">
	DELETE
	FROM   TC_API_STND
	WHERE  SVR_ID = #{svrId}
	</delete>
	
</mapper>